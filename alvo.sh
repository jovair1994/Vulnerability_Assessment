#!/bin/bash

sudo apt update -y

sudo apt upgrade -y 

sudo apt install p7zip-full docker.io -y

sudo systemctl enable docker --now

cat << EOF > /opt/docker-compose.yml

version: '2'
services:
  web:
    image: vulhub/apache-druid:0.20.0
    ports:
      - "8888:8888"
    networks:
      my_network:
        ipv4_address: 172.100.0.10
networks:
  my_network:
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 172.100.0.0/24

EOF

sudo docker-compose up -d

wget https://github.com/jovair1994/Vulnerability_Assessment/raw/main/Nessus-10.6.4-debian10_amd64.zip.001 -O /home/kali/Downloads/Nessus-10.6.4-debian10_amd64.zip.001
wget https://github.com/jovair1994/Vulnerability_Assessment/raw/main/Nessus-10.6.4-debian10_amd64.zip.002 -O /home/kali/Downloads/Nessus-10.6.4-debian10_amd64.zip.002
wget https://github.com/jovair1994/Vulnerability_Assessment/raw/main/Nessus-10.6.4-debian10_amd64.zip.003 -O /home/kali/Downloads/Nessus-10.6.4-debian10_amd64.zip.003
wget https://github.com/jovair1994/Vulnerability_Assessment/raw/main/Nessus-10.6.4-debian10_amd64.zip.004 -O /home/kali/Downloads/Nessus-10.6.4-debian10_amd64.zip.004
wget https://github.com/jovair1994/Vulnerability_Assessment/raw/main/Nessus-10.6.4-debian10_amd64.zip.005 -O /home/kali/Downloads/Nessus-10.6.4-debian10_amd64.zip.005
wget https://github.com/jovair1994/Vulnerability_Assessment/raw/main/Nessus-10.6.4-debian10_amd64.zip.006 -O /home/kali/Downloads/Nessus-10.6.4-debian10_amd64.zip.006
wget https://github.com/jovair1994/Vulnerability_Assessment/raw/main/Nessus-10.6.4-debian10_amd64.zip.007 -O /home/kali/Downloads/Nessus-10.6.4-debian10_amd64.zip.007

7z x Nessus-10.6.4-debian10_amd64.zip.001

wget https://raw.githubusercontent.com/eelsivart/nessus-report-downloader/master/nessus6-report-downloader.rb -O /home/kali/nessus-report-downloader.rb

chmod +x /home/kali/nessus-report-downloader.rb

echo "net.ipv6.conf.all.disable_ipv6 = 1" >> /etc/sysctl.conf
echo "net.ipv6.conf.default.disable_ipv6 = 1" >> /etc/sysctl.conf
sed -i 's/GRUB_CMDLINE_LINUX_DEFAULT=""/GRUB_CMDLINE_LINUX_DEFAULT="ipv6.disable=1"/' /etc/default/grub
sed -i 's/GRUB_CMDLINE_LINUX=""/GRUB_CMDLINE_LINUX="ipv6.disable=1"/' /etc/default/grub
update-grub

hostnamectl set-hostname KALI
cat << EOF > /etc/hosts
127.0.0.1 localhost
127.0.0.1 kali
EOF

rm -rf /root/.cache
rm -rf /root/.viminfo
rm -rf /home/admin/.sudo_as_admin_successful
rm -rf /home/admin/.cache
rm -rf /home/admin/.viminfo



ln -sf /dev/null /root/.bash_history
ln -sf /dev/null /home/admin/.bash_history

reboot
